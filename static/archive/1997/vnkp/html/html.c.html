<html>
<head>
<title>html.c (html)</title></head>
<body bgcolor="white">
<pre>
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

#define MAXWIDTH   80
#define MAXLINES  750
#define SEP         9    /* a TAB, randomly chosen separator of columns :*/
#define SEPSTR   "\t"    /* Same, now in string format */

char table[MAXLINES][MAXWIDTH+1];
int width[MAXWIDTH+1],totwidth[MAXWIDTH+1];
int lines,columns,curcol;
char sym[MAXWIDTH+1];

void InitTable() {
  int i;
  lines=columns=0;
  for (i=0;i&lt;MAXLINES;i++) table[i][0]='\0';
  for (i=0;i&lt;MAXWIDTH;i++) width[i]=0;
}


void NextSym() {
  char str[MAXWIDTH+1];
  if (scanf(" &lt;%[^&gt;]&gt;",str)) {
    sprintf(sym,"&lt;%s&gt;",str);
  } else {
    scanf("%[^&lt; \n]",sym);
  }
}

void ReadItem() {
  if (!strcmp("&lt;TD&gt;",sym)) {
    int itemwidth=0;
    if (curcol) strcat(table[lines],SEPSTR);
    NextSym(); /* useful string or &lt;/TD&gt; */
    while (strcmp("&lt;/TD&gt;",sym)) {
      if (itemwidth) {
        itemwidth++;
        strcat(table[lines]," ");
      }
      itemwidth+=strlen(sym);
      strcat(table[lines],sym);
      if (itemwidth&gt;width[curcol]) width[curcol]=itemwidth;
      NextSym();
    }
    curcol++; 
    if (curcol&gt;columns) columns++;
  }
}

void ReadLine() {
  int i;
  if (!strcmp("&lt;TR&gt;",sym)) {
    curcol=0;
    NextSym(); /* &lt;TD&gt; or &lt;/TR&gt; */
    while (strcmp("&lt;/TR&gt;",sym)) {
      ReadItem();
      NextSym();
    }
    for (i=strlen(table[lines]);i&lt;MAXWIDTH;i++) table[lines][i]=SEP;
    lines++;
  }
}

void ReadTable() {
  NextSym(); /* assume this IS &lt;TABLE&gt; */
  NextSym(); /* &lt;TR&gt; or &lt;/TABLE&gt; */
  while (strcmp("&lt;/TABLE&gt;",sym)) {
    ReadLine();
    NextSym();
  }
}

void WriteRuler() {
  int i,j;
  for (i=0;i&lt;columns;i++) {
    printf("+");
    for (j=0;j&lt;=width[i];j++) printf("-");
    if (width[i]) printf("-");
  }
  printf("+\n");
}

void WriteTable() {
  int i,j,k; /* run through table&amp;width */
  int pos;   /* run over screen (without delimiters) */
  totwidth[0]=width[0];
  for (k=1;k&lt;MAXWIDTH;k++) totwidth[k]=totwidth[k-1]+width[k];
  WriteRuler();
  for (i=0;i&lt;lines;i++) {
    k=pos=0;
    for (j=0;j&lt;columns;j++) {
      printf("| ");
      while (table[i][k]!=SEP) {
        printf("%c",table[i][k]);
        k++; /* printed char */
        pos++;
      }
      k++; /* SEP itself */
      for (;pos&lt;totwidth[j];pos++) printf(" ");
      if (width[j]) printf(" ");
    }
    printf("|\n");
    WriteRuler();
  }
}

int main() {
  int r,runs;
  scanf("%d",&amp;runs);
  for (r=0;r&lt;runs;r++) {
    InitTable();
    ReadTable();
    WriteTable();
  }
  return(0);
}
</pre>
<hr noshade>
<address>Generated by Java2Html</address>
</body>
</html>
